2025-07-18 11:24:12.705 | INFO     | __init__                       | ================================================================================
2025-07-18 11:24:12.706 | INFO     | __init__                       | TE-AI RUN INITIALIZED: 20250718_112412
2025-07-18 11:24:12.706 | INFO     | __init__                       | Log file: logs/te_ai_run_20250718_112412.log
2025-07-18 11:24:12.706 | INFO     | __init__                       | Max file size: 50.0 MB
2025-07-18 11:24:12.706 | INFO     | __init__                       | Backup files: 10
2025-07-18 11:24:12.706 | INFO     | __init__                       | ================================================================================
2025-07-18 11:24:12.707 | INFO     | _log_system_info               | SYSTEM INFORMATION:
2025-07-18 11:24:12.708 | INFO     | _log_system_info               |   Python version: 3.12.8 | packaged by Anaconda, Inc. | (main, Dec 11 2024, 16:31:09) [GCC 11.2.0]
2025-07-18 11:24:12.708 | INFO     | _log_system_info               |   PyTorch version: 2.7.1+cu126
2025-07-18 11:24:12.708 | INFO     | _log_system_info               |   CUDA available: True
2025-07-18 11:24:12.737 | INFO     | _log_system_info               |   CUDA device: NVIDIA GeForce RTX 3090
2025-07-18 11:24:12.738 | INFO     | _log_system_info               |   CUDA memory: 25.77 GB
2025-07-18 11:24:12.738 | INFO     | _log_system_info               | --------------------------------------------------------------------------------
2025-07-18 11:24:55.775 | INFO     | info                           | 
============================================================
2025-07-18 11:24:55.775 | INFO     | info                           | INITIALIZING SYMBIOTIC SWARM TEST
2025-07-18 11:24:55.775 | INFO     | info                           | ============================================================

2025-07-18 11:24:55.775 | INFO     | info                           | Loading 'bbbp' dataset...
2025-07-18 11:24:55.776 | INFO     | info                           | Loading bbbp from MoleculeNet...
2025-07-18 11:24:55.776 | INFO     | info                           | Successfully initialized RDKit MorganGenerator.
2025-07-18 11:24:55.776 | INFO     | info                           | Using RobustFeaturizer wrapping RDKit MorganGenerator.
2025-07-18 11:24:55.776 | INFO     | info                           | Using DeepChem data directory: deepchem_data
2025-07-18 11:24:55.777 | INFO     | info                           | Data directory exists: deepchem_data
2025-07-18 11:24:55.777 | WARNING  | warning                        | BBBP dataset directory not found: deepchem_data/bbbp
2025-07-18 11:24:55.800 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'O=N([O-])C1=C(CN=C1NCCSCc2ncccc2)Cc3ccccc3'. Returning zero vector.
2025-07-18 11:24:55.800 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'c1(nc(NC(N)=[NH2])sc1)CSCCNC(=[NH]C#N)NC'. Returning zero vector.
2025-07-18 11:24:55.843 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'Cc1nc(sc1)\[NH]=C(\N)N'. Returning zero vector.
2025-07-18 11:24:55.867 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 's1cc(CSCCN\C(NC)=[NH]\C#N)nc1\[NH]=C(\N)N'. Returning zero vector.
2025-07-18 11:24:55.871 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'c1c(c(ncc1)CSCCN\C(=[NH]\C#N)NCC)Br'. Returning zero vector.
2025-07-18 11:24:55.872 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'n1c(csc1\[NH]=C(\N)N)c1ccccc1'. Returning zero vector.
2025-07-18 11:24:55.872 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'n1c(csc1\[NH]=C(\N)N)c1cccc(c1)N'. Returning zero vector.
2025-07-18 11:24:55.873 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'n1c(csc1\[NH]=C(\N)N)c1cccc(c1)NC(C)=O'. Returning zero vector.
2025-07-18 11:24:55.873 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'n1c(csc1\[NH]=C(\N)N)c1cccc(c1)N\C(NC)=[NH]\C#N'. Returning zero vector.
2025-07-18 11:24:55.874 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 's1cc(nc1\[NH]=C(\N)N)C'. Returning zero vector.
2025-07-18 11:24:55.878 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'c1(cc(N\C(=[NH]\c2cccc(c2)CC)C)ccc1)CC'. Returning zero vector.
2025-07-18 11:24:56.086 | INFO     | info                           | Step 2: Filtering out invalid molecules before splitting...
2025-07-18 11:24:56.251 | WARNING  | warning                        | Removed 11 invalid SMILES strings before splitting.
2025-07-18 11:24:56.275 | INFO     | info                           | Step 3: Splitting the cleaned dataset...
2025-07-18 11:24:56.770 | INFO     | info                           | Step 4: Applying data transformations...
2025-07-18 11:24:56.787 | INFO     | info                           | Converting 1631 molecules from DeepChem
2025-07-18 11:25:04.552 | INFO     | info                           | Successfully converted 1631 molecules
2025-07-18 11:25:04.553 | INFO     | info                           | Converting 204 molecules from DeepChem
2025-07-18 11:25:04.873 | INFO     | info                           | Successfully converted 204 molecules
2025-07-18 11:25:04.874 | INFO     | info                           | Converting 204 molecules from DeepChem
2025-07-18 11:25:05.159 | INFO     | info                           | Successfully converted 204 molecules
2025-07-18 11:25:05.159 | INFO     | info                           | Successfully converted bbbp:
2025-07-18 11:25:05.159 | INFO     | info                           |   Train: 1631 antigens
2025-07-18 11:25:05.160 | INFO     | info                           |   Valid: 204 antigens
2025-07-18 11:25:05.160 | INFO     | info                           |   Test: 204 antigens
2025-07-18 11:25:05.161 | INFO     | info                           | Loaded 1631 training samples.
2025-07-18 11:25:05.161 | INFO     | info                           | üèùÔ∏è  Initializing Archipelago with 3 islands across devices: ['cuda:0', 'cuda:0', 'cuda:0']
2025-07-18 11:25:05.162 | INFO     | info                           |    Creating Island 1 on device cuda:0...
2025-07-18 11:25:05.422 | INFO     | info                           | GPU Memory: 0.00/24.00 GB (0.0%)
2025-07-18 11:25:05.423 | INFO     | info                           | 
üß¨ Initializing production population with 64 cells...
2025-07-18 11:25:05.423 | INFO     | info                           |    Creating 12 dedicated stem cells...
2025-07-18 11:25:05.800 | INFO     | info                           |    Creating 52 mixed-type cells...
2025-07-18 11:25:05.890 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:05.929 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:06.393 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:06.866 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:06.931 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:06.966 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:06.998 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:07.122 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:07.532 | INFO     | info                           |    Created 50/52 mixed cells...
2025-07-18 11:25:07.595 | INFO     | info                           | ‚úÖ‚úÖ  Population initialized with 64 cells (12 stem cells + 52 mixed)  ‚úÖ‚úÖ 
2025-07-18 11:25:07.619 | INFO     | info                           |    Creating Island 2 on device cuda:0...
2025-07-18 11:25:07.627 | INFO     | info                           | GPU Memory: 1.77/24.00 GB (7.4%)
2025-07-18 11:25:07.627 | INFO     | info                           | 
üß¨ Initializing production population with 64 cells...
2025-07-18 11:25:07.627 | INFO     | info                           |    Creating 12 dedicated stem cells...
2025-07-18 11:25:07.985 | INFO     | info                           |    Creating 52 mixed-type cells...
2025-07-18 11:25:08.070 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:08.103 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:08.537 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:08.800 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:08.863 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:08.898 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:08.928 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:09.055 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:09.475 | INFO     | info                           |    Created 50/52 mixed cells...
2025-07-18 11:25:09.533 | INFO     | info                           | ‚úÖ‚úÖ  Population initialized with 64 cells (12 stem cells + 52 mixed)  ‚úÖ‚úÖ 
2025-07-18 11:25:09.534 | INFO     | info                           |    Creating Island 3 on device cuda:0...
2025-07-18 11:25:09.541 | INFO     | info                           | GPU Memory: 3.54/24.00 GB (14.8%)
2025-07-18 11:25:09.541 | INFO     | info                           | 
üß¨ Initializing production population with 64 cells...
2025-07-18 11:25:09.541 | INFO     | info                           |    Creating 12 dedicated stem cells...
2025-07-18 11:25:09.915 | INFO     | info                           |    Creating 52 mixed-type cells...
2025-07-18 11:25:10.010 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:10.419 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:10.449 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:10.661 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:10.843 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:10.880 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:11.622 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:11.712 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:25:11.798 | INFO     | info                           |    Created 50/52 mixed cells...
2025-07-18 11:25:11.869 | INFO     | info                           | ‚úÖ‚úÖ  Population initialized with 64 cells (12 stem cells + 52 mixed)  ‚úÖ‚úÖ 
2025-07-18 11:25:11.870 | INFO     | info                           | 
--- Starting Cultivation Loop ---
2025-07-18 11:25:11.878 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 1 ==============================
2025-07-18 11:25:11.879 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:11.879 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:11.886 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:11.887 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:11.899 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:11.899 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:11.899 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:11.899 | INFO     | info                           | GENERATION 1
2025-07-18 11:25:11.899 | INFO     | info                           | GENERATION 1
2025-07-18 11:25:11.899 | INFO     | info                           | GENERATION 1
2025-07-18 11:25:11.900 | INFO     | info                           | ================================================================================
2025-07-18 11:25:11.900 | INFO     | info                           | ================================================================================
2025-07-18 11:25:11.900 | INFO     | info                           | ================================================================================
2025-07-18 11:25:11.928 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:11.928 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:11.928 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:12.314 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.325 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.331 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.331 | INFO     | info                           |    All islands have completed Generation 1.
2025-07-18 11:25:12.335 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 2 ==============================
2025-07-18 11:25:12.338 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:12.338 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:12.338 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:12.338 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:12.358 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:12.359 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:12.359 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:12.359 | INFO     | info                           | GENERATION 2
2025-07-18 11:25:12.359 | INFO     | info                           | GENERATION 2
2025-07-18 11:25:12.359 | INFO     | info                           | GENERATION 2
2025-07-18 11:25:12.359 | INFO     | info                           | ================================================================================
2025-07-18 11:25:12.359 | INFO     | info                           | ================================================================================
2025-07-18 11:25:12.359 | INFO     | info                           | ================================================================================
2025-07-18 11:25:12.392 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:12.392 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:12.392 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:12.407 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.414 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.420 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.420 | INFO     | info                           |    All islands have completed Generation 2.
2025-07-18 11:25:12.424 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 3 ==============================
2025-07-18 11:25:12.424 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:12.424 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:12.424 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:12.424 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:12.442 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:12.442 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:12.442 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:12.443 | INFO     | info                           | GENERATION 3
2025-07-18 11:25:12.443 | INFO     | info                           | GENERATION 3
2025-07-18 11:25:12.443 | INFO     | info                           | GENERATION 3
2025-07-18 11:25:12.443 | INFO     | info                           | ================================================================================
2025-07-18 11:25:12.443 | INFO     | info                           | ================================================================================
2025-07-18 11:25:12.443 | INFO     | info                           | ================================================================================
2025-07-18 11:25:12.482 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:12.482 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:12.482 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:12.499 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.504 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.509 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.509 | INFO     | info                           |    All islands have completed Generation 3.
2025-07-18 11:25:12.513 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 4 ==============================
2025-07-18 11:25:12.513 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:12.513 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:12.518 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:12.519 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:12.531 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:12.531 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:12.531 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:12.531 | INFO     | info                           | GENERATION 4
2025-07-18 11:25:12.532 | INFO     | info                           | GENERATION 4
2025-07-18 11:25:12.532 | INFO     | info                           | GENERATION 4
2025-07-18 11:25:12.532 | INFO     | info                           | ================================================================================
2025-07-18 11:25:12.532 | INFO     | info                           | ================================================================================
2025-07-18 11:25:12.532 | INFO     | info                           | ================================================================================
2025-07-18 11:25:12.569 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:12.569 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:12.569 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:12.587 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.593 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.599 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.599 | INFO     | info                           |    All islands have completed Generation 4.
2025-07-18 11:25:12.603 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 5 ==============================
2025-07-18 11:25:12.603 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:12.604 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:12.604 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:12.604 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:12.621 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:12.621 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:12.621 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:12.621 | INFO     | info                           | GENERATION 5
2025-07-18 11:25:12.621 | INFO     | info                           | GENERATION 5
2025-07-18 11:25:12.621 | INFO     | info                           | GENERATION 5
2025-07-18 11:25:12.622 | INFO     | info                           | ================================================================================
2025-07-18 11:25:12.622 | INFO     | info                           | ================================================================================
2025-07-18 11:25:12.622 | INFO     | info                           | ================================================================================
2025-07-18 11:25:12.665 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:12.665 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:12.665 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:12.682 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.687 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.693 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:12.693 | INFO     | info                           |    All islands have completed Generation 5.
2025-07-18 11:25:12.694 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 5 ‚õµ
2025-07-18 11:25:12.694 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:12.694 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:12.694 | INFO     | info                           |    Island 3 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:12.996 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:25:13.232 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:25:13.471 | INFO     | info                           |    Island 3 (on cuda:0) received 5 new cells.
2025-07-18 11:25:13.475 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 6 ==============================
2025-07-18 11:25:13.475 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:13.475 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:13.476 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:13.476 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:13.495 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.495 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.495 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.495 | INFO     | info                           | GENERATION 6
2025-07-18 11:25:13.495 | INFO     | info                           | GENERATION 6
2025-07-18 11:25:13.495 | INFO     | info                           | GENERATION 6
2025-07-18 11:25:13.495 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.496 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.496 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.531 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.531 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.531 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.550 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.557 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.563 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.563 | INFO     | info                           |    All islands have completed Generation 6.
2025-07-18 11:25:13.567 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 7 ==============================
2025-07-18 11:25:13.567 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:13.567 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:13.567 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:13.570 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:13.584 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.584 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.584 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.584 | INFO     | info                           | GENERATION 7
2025-07-18 11:25:13.584 | INFO     | info                           | GENERATION 7
2025-07-18 11:25:13.584 | INFO     | info                           | GENERATION 7
2025-07-18 11:25:13.584 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.584 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.584 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.613 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.613 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.613 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.628 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.634 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.641 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.641 | INFO     | info                           |    All islands have completed Generation 7.
2025-07-18 11:25:13.645 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 8 ==============================
2025-07-18 11:25:13.645 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:13.645 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:13.646 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:13.646 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:13.663 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.663 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.663 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.663 | INFO     | info                           | GENERATION 8
2025-07-18 11:25:13.664 | INFO     | info                           | GENERATION 8
2025-07-18 11:25:13.664 | INFO     | info                           | GENERATION 8
2025-07-18 11:25:13.664 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.664 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.664 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.705 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.705 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.706 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.720 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.726 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.732 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.732 | INFO     | info                           |    All islands have completed Generation 8.
2025-07-18 11:25:13.736 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 9 ==============================
2025-07-18 11:25:13.736 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:13.736 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:13.736 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:13.736 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:13.753 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.753 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.753 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.753 | INFO     | info                           | GENERATION 9
2025-07-18 11:25:13.753 | INFO     | info                           | GENERATION 9
2025-07-18 11:25:13.754 | INFO     | info                           | GENERATION 9
2025-07-18 11:25:13.754 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.754 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.754 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.784 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.784 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.784 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.800 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.806 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.812 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.812 | INFO     | info                           |    All islands have completed Generation 9.
2025-07-18 11:25:13.816 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 10 ==============================
2025-07-18 11:25:13.817 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:13.817 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:13.822 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:13.822 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:13.835 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.835 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.835 | INFO     | info                           | GENERATION 10
2025-07-18 11:25:13.835 | INFO     | info                           | GENERATION 10
2025-07-18 11:25:13.835 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.836 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.837 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:13.837 | INFO     | info                           | GENERATION 10
2025-07-18 11:25:13.838 | INFO     | info                           | ================================================================================
2025-07-18 11:25:13.869 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.869 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.869 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:13.887 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.892 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.897 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:13.897 | INFO     | info                           |    All islands have completed Generation 10.
2025-07-18 11:25:13.898 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 10 ‚õµ
2025-07-18 11:25:13.898 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:13.898 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:13.898 | INFO     | info                           |    Island 3 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:14.158 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:25:14.399 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:25:14.642 | INFO     | info                           |    Island 3 (on cuda:0) received 5 new cells.
2025-07-18 11:25:14.646 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 11 ==============================
2025-07-18 11:25:14.646 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:14.646 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:14.647 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:14.647 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:14.671 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:14.671 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:14.671 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:14.671 | INFO     | info                           | GENERATION 11
2025-07-18 11:25:14.671 | INFO     | info                           | GENERATION 11
2025-07-18 11:25:14.672 | INFO     | info                           | GENERATION 11
2025-07-18 11:25:14.672 | INFO     | info                           | ================================================================================
2025-07-18 11:25:14.672 | INFO     | info                           | ================================================================================
2025-07-18 11:25:14.672 | INFO     | info                           | ================================================================================
2025-07-18 11:25:14.710 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:14.710 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:14.710 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:14.726 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:14.731 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:14.737 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:14.738 | INFO     | info                           |    All islands have completed Generation 11.
2025-07-18 11:25:14.741 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 12 ==============================
2025-07-18 11:25:14.741 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:14.742 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:14.742 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:14.742 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:14.757 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:14.757 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:14.757 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:14.758 | INFO     | info                           | GENERATION 12
2025-07-18 11:25:14.758 | INFO     | info                           | GENERATION 12
2025-07-18 11:25:14.758 | INFO     | info                           | GENERATION 12
2025-07-18 11:25:14.758 | INFO     | info                           | ================================================================================
2025-07-18 11:25:14.758 | INFO     | info                           | ================================================================================
2025-07-18 11:25:14.758 | INFO     | info                           | ================================================================================
2025-07-18 11:25:14.794 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:14.794 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:14.794 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:14.809 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:14.816 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:14.823 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:14.823 | INFO     | info                           |    All islands have completed Generation 12.
2025-07-18 11:25:14.826 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 13 ==============================
2025-07-18 11:25:14.827 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:14.827 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:14.827 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:14.827 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:14.843 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:14.843 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:14.843 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:14.844 | INFO     | info                           | GENERATION 13
2025-07-18 11:25:14.844 | INFO     | info                           | GENERATION 13
2025-07-18 11:25:14.844 | INFO     | info                           | GENERATION 13
2025-07-18 11:25:14.844 | INFO     | info                           | ================================================================================
2025-07-18 11:25:14.844 | INFO     | info                           | ================================================================================
2025-07-18 11:25:14.844 | INFO     | info                           | ================================================================================
2025-07-18 11:25:14.875 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:14.875 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:14.875 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:14.890 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:14.897 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:14.902 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:14.902 | INFO     | info                           |    All islands have completed Generation 13.
2025-07-18 11:25:14.906 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 14 ==============================
2025-07-18 11:25:14.906 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:14.906 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:14.910 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:14.910 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:14.923 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:14.923 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:14.923 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:14.923 | INFO     | info                           | GENERATION 14
2025-07-18 11:25:14.923 | INFO     | info                           | GENERATION 14
2025-07-18 11:25:14.923 | INFO     | info                           | GENERATION 14
2025-07-18 11:25:14.924 | INFO     | info                           | ================================================================================
2025-07-18 11:25:14.924 | INFO     | info                           | ================================================================================
2025-07-18 11:25:14.924 | INFO     | info                           | ================================================================================
2025-07-18 11:25:14.955 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:14.955 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:14.956 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:14.972 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:14.978 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:14.984 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:14.985 | INFO     | info                           |    All islands have completed Generation 14.
2025-07-18 11:25:14.988 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 15 ==============================
2025-07-18 11:25:14.989 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:14.989 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:14.989 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:14.989 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:15.007 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:15.008 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:15.008 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:15.008 | INFO     | info                           | GENERATION 15
2025-07-18 11:25:15.008 | INFO     | info                           | GENERATION 15
2025-07-18 11:25:15.008 | INFO     | info                           | GENERATION 15
2025-07-18 11:25:15.008 | INFO     | info                           | ================================================================================
2025-07-18 11:25:15.008 | INFO     | info                           | ================================================================================
2025-07-18 11:25:15.008 | INFO     | info                           | ================================================================================
2025-07-18 11:25:15.036 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:15.037 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:15.037 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:15.052 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:15.058 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:15.064 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:15.064 | INFO     | info                           |    All islands have completed Generation 15.
2025-07-18 11:25:15.064 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 15 ‚õµ
2025-07-18 11:25:15.064 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:15.065 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:15.065 | INFO     | info                           |    Island 3 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:15.315 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:25:15.573 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:25:15.804 | INFO     | info                           |    Island 3 (on cuda:0) received 5 new cells.
2025-07-18 11:25:15.810 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 16 ==============================
2025-07-18 11:25:15.810 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:15.810 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:15.814 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:15.814 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:15.834 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:15.834 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:15.834 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:15.834 | INFO     | info                           | GENERATION 16
2025-07-18 11:25:15.834 | INFO     | info                           | GENERATION 16
2025-07-18 11:25:15.834 | INFO     | info                           | GENERATION 16
2025-07-18 11:25:15.835 | INFO     | info                           | ================================================================================
2025-07-18 11:25:15.835 | INFO     | info                           | ================================================================================
2025-07-18 11:25:15.835 | INFO     | info                           | ================================================================================
2025-07-18 11:25:15.864 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:15.864 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:15.864 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:15.878 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:15.882 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:15.887 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:15.887 | INFO     | info                           |    All islands have completed Generation 16.
2025-07-18 11:25:15.891 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 17 ==============================
2025-07-18 11:25:15.891 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:15.891 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:15.891 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:15.892 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:15.906 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:15.906 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:15.906 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:15.906 | INFO     | info                           | GENERATION 17
2025-07-18 11:25:15.907 | INFO     | info                           | GENERATION 17
2025-07-18 11:25:15.907 | INFO     | info                           | GENERATION 17
2025-07-18 11:25:15.907 | INFO     | info                           | ================================================================================
2025-07-18 11:25:15.907 | INFO     | info                           | ================================================================================
2025-07-18 11:25:15.907 | INFO     | info                           | ================================================================================
2025-07-18 11:25:15.942 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:15.942 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:15.942 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:15.959 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:15.964 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:15.969 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:15.969 | INFO     | info                           |    All islands have completed Generation 17.
2025-07-18 11:25:15.974 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 18 ==============================
2025-07-18 11:25:15.974 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:15.974 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:15.975 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:15.975 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:15.987 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:15.988 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:15.988 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:15.988 | INFO     | info                           | GENERATION 18
2025-07-18 11:25:15.988 | INFO     | info                           | GENERATION 18
2025-07-18 11:25:15.988 | INFO     | info                           | GENERATION 18
2025-07-18 11:25:15.988 | INFO     | info                           | ================================================================================
2025-07-18 11:25:15.988 | INFO     | info                           | ================================================================================
2025-07-18 11:25:15.989 | INFO     | info                           | ================================================================================
2025-07-18 11:25:16.017 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:16.017 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:16.017 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:16.032 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:16.037 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:16.042 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:16.042 | INFO     | info                           |    All islands have completed Generation 18.
2025-07-18 11:25:16.046 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 19 ==============================
2025-07-18 11:25:16.046 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:16.046 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:16.046 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:16.046 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:16.063 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:16.063 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:16.063 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:16.063 | INFO     | info                           | GENERATION 19
2025-07-18 11:25:16.063 | INFO     | info                           | GENERATION 19
2025-07-18 11:25:16.063 | INFO     | info                           | GENERATION 19
2025-07-18 11:25:16.063 | INFO     | info                           | ================================================================================
2025-07-18 11:25:16.063 | INFO     | info                           | ================================================================================
2025-07-18 11:25:16.064 | INFO     | info                           | ================================================================================
2025-07-18 11:25:16.099 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:16.099 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:16.099 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:16.115 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:16.120 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:16.125 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:16.125 | INFO     | info                           |    All islands have completed Generation 19.
2025-07-18 11:25:16.129 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 20 ==============================
2025-07-18 11:25:16.129 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:16.129 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:16.130 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:16.130 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:16.147 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:16.147 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:16.147 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:16.147 | INFO     | info                           | GENERATION 20
2025-07-18 11:25:16.148 | INFO     | info                           | GENERATION 20
2025-07-18 11:25:16.148 | INFO     | info                           | GENERATION 20
2025-07-18 11:25:16.148 | INFO     | info                           | ================================================================================
2025-07-18 11:25:16.148 | INFO     | info                           | ================================================================================
2025-07-18 11:25:16.148 | INFO     | info                           | ================================================================================
2025-07-18 11:25:16.193 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:16.193 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:16.194 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:16.209 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:16.214 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:16.220 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:16.220 | INFO     | info                           |    All islands have completed Generation 20.
2025-07-18 11:25:16.220 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 20 ‚õµ
2025-07-18 11:25:16.220 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:16.220 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:16.221 | INFO     | info                           |    Island 3 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:16.518 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:25:16.782 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:25:17.036 | INFO     | info                           |    Island 3 (on cuda:0) received 5 new cells.
2025-07-18 11:25:17.040 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 21 ==============================
2025-07-18 11:25:17.040 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:17.040 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:17.041 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:17.041 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:17.058 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.059 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.059 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.059 | INFO     | info                           | GENERATION 21
2025-07-18 11:25:17.059 | INFO     | info                           | GENERATION 21
2025-07-18 11:25:17.059 | INFO     | info                           | GENERATION 21
2025-07-18 11:25:17.059 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.059 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.059 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.096 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.096 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.096 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.112 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.118 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.123 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.123 | INFO     | info                           |    All islands have completed Generation 21.
2025-07-18 11:25:17.126 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 22 ==============================
2025-07-18 11:25:17.127 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:17.127 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:17.127 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:17.128 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:17.144 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.144 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.144 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.145 | INFO     | info                           | GENERATION 22
2025-07-18 11:25:17.145 | INFO     | info                           | GENERATION 22
2025-07-18 11:25:17.145 | INFO     | info                           | GENERATION 22
2025-07-18 11:25:17.145 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.145 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.145 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.191 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.191 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.191 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.209 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.214 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.220 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.220 | INFO     | info                           |    All islands have completed Generation 22.
2025-07-18 11:25:17.224 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 23 ==============================
2025-07-18 11:25:17.224 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:17.224 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:17.224 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:17.224 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:17.241 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.241 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.241 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.241 | INFO     | info                           | GENERATION 23
2025-07-18 11:25:17.241 | INFO     | info                           | GENERATION 23
2025-07-18 11:25:17.241 | INFO     | info                           | GENERATION 23
2025-07-18 11:25:17.241 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.242 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.242 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.286 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.286 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.286 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.305 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.312 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.319 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.319 | INFO     | info                           |    All islands have completed Generation 23.
2025-07-18 11:25:17.323 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 24 ==============================
2025-07-18 11:25:17.323 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:17.324 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:17.324 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:17.324 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:17.339 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.339 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.340 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.340 | INFO     | info                           | GENERATION 24
2025-07-18 11:25:17.340 | INFO     | info                           | GENERATION 24
2025-07-18 11:25:17.340 | INFO     | info                           | GENERATION 24
2025-07-18 11:25:17.340 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.340 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.340 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.384 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.385 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.385 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.402 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.408 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.414 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.414 | INFO     | info                           |    All islands have completed Generation 24.
2025-07-18 11:25:17.418 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 25 ==============================
2025-07-18 11:25:17.418 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:17.419 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:17.419 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:17.419 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:17.436 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.436 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.436 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:17.436 | INFO     | info                           | GENERATION 25
2025-07-18 11:25:17.437 | INFO     | info                           | GENERATION 25
2025-07-18 11:25:17.437 | INFO     | info                           | GENERATION 25
2025-07-18 11:25:17.437 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.437 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.437 | INFO     | info                           | ================================================================================
2025-07-18 11:25:17.482 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.482 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.482 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:17.501 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.506 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.513 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:17.513 | INFO     | info                           |    All islands have completed Generation 25.
2025-07-18 11:25:17.513 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 25 ‚õµ
2025-07-18 11:25:17.513 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:17.514 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:17.514 | INFO     | info                           |    Island 3 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:17.787 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:25:18.034 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:25:18.272 | INFO     | info                           |    Island 3 (on cuda:0) received 5 new cells.
2025-07-18 11:25:18.276 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 26 ==============================
2025-07-18 11:25:18.277 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:18.277 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:18.277 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:18.277 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:18.294 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.294 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.294 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.294 | INFO     | info                           | GENERATION 26
2025-07-18 11:25:18.294 | INFO     | info                           | GENERATION 26
2025-07-18 11:25:18.294 | INFO     | info                           | GENERATION 26
2025-07-18 11:25:18.295 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.295 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.295 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.324 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.324 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.324 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.342 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.348 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.353 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.353 | INFO     | info                           |    All islands have completed Generation 26.
2025-07-18 11:25:18.357 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 27 ==============================
2025-07-18 11:25:18.357 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:18.357 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:18.357 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:18.357 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:18.371 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.371 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.372 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.372 | INFO     | info                           | GENERATION 27
2025-07-18 11:25:18.372 | INFO     | info                           | GENERATION 27
2025-07-18 11:25:18.372 | INFO     | info                           | GENERATION 27
2025-07-18 11:25:18.372 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.372 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.372 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.404 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.404 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.404 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.419 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.425 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.434 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.434 | INFO     | info                           |    All islands have completed Generation 27.
2025-07-18 11:25:18.438 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 28 ==============================
2025-07-18 11:25:18.438 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:18.439 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:18.439 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:18.439 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:18.462 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.462 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.462 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.462 | INFO     | info                           | GENERATION 28
2025-07-18 11:25:18.462 | INFO     | info                           | GENERATION 28
2025-07-18 11:25:18.462 | INFO     | info                           | GENERATION 28
2025-07-18 11:25:18.462 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.463 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.463 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.501 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.501 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.501 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.517 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.523 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.529 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.529 | INFO     | info                           |    All islands have completed Generation 28.
2025-07-18 11:25:18.532 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 29 ==============================
2025-07-18 11:25:18.533 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:18.533 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:18.533 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:18.533 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:18.550 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.550 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.550 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.551 | INFO     | info                           | GENERATION 29
2025-07-18 11:25:18.551 | INFO     | info                           | GENERATION 29
2025-07-18 11:25:18.551 | INFO     | info                           | GENERATION 29
2025-07-18 11:25:18.551 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.551 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.551 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.599 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.600 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.600 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.615 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.624 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.630 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.630 | INFO     | info                           |    All islands have completed Generation 29.
2025-07-18 11:25:18.634 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 30 ==============================
2025-07-18 11:25:18.634 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:25:18.635 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:25:18.635 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:25:18.635 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:25:18.658 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.659 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.659 | INFO     | info                           | 
================================================================================
2025-07-18 11:25:18.659 | INFO     | info                           | GENERATION 30
2025-07-18 11:25:18.659 | INFO     | info                           | GENERATION 30
2025-07-18 11:25:18.659 | INFO     | info                           | GENERATION 30
2025-07-18 11:25:18.659 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.659 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.659 | INFO     | info                           | ================================================================================
2025-07-18 11:25:18.704 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.704 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.704 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:25:18.721 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.727 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.732 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:25:18.732 | INFO     | info                           |    All islands have completed Generation 30.
2025-07-18 11:25:18.732 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 30 ‚õµ
2025-07-18 11:25:18.733 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:18.733 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:18.733 | INFO     | info                           |    Island 3 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:25:19.080 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:25:19.354 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:25:19.887 | INFO     | info                           |    Island 3 (on cuda:0) received 5 new cells.
2025-07-18 11:25:19.887 | INFO     | info                           | 
--- Cultivation Complete ---
2025-07-18 11:25:19.887 | INFO     | info                           | Total time for 30 generations: 8.02 seconds.

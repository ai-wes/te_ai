2025-07-18 11:14:24.571 | INFO     | __init__                       | ================================================================================
2025-07-18 11:14:24.572 | INFO     | __init__                       | TE-AI RUN INITIALIZED: 20250718_111424
2025-07-18 11:14:24.572 | INFO     | __init__                       | Log file: logs/te_ai_run_20250718_111424.log
2025-07-18 11:14:24.572 | INFO     | __init__                       | Max file size: 50.0 MB
2025-07-18 11:14:24.572 | INFO     | __init__                       | Backup files: 10
2025-07-18 11:14:24.572 | INFO     | __init__                       | ================================================================================
2025-07-18 11:14:24.573 | INFO     | _log_system_info               | SYSTEM INFORMATION:
2025-07-18 11:14:24.573 | INFO     | _log_system_info               |   Python version: 3.12.8 | packaged by Anaconda, Inc. | (main, Dec 11 2024, 16:31:09) [GCC 11.2.0]
2025-07-18 11:14:24.574 | INFO     | _log_system_info               |   PyTorch version: 2.7.1+cu126
2025-07-18 11:14:24.574 | INFO     | _log_system_info               |   CUDA available: True
2025-07-18 11:14:24.601 | INFO     | _log_system_info               |   CUDA device: NVIDIA GeForce RTX 3090
2025-07-18 11:14:24.601 | INFO     | _log_system_info               |   CUDA memory: 25.77 GB
2025-07-18 11:14:24.601 | INFO     | _log_system_info               | --------------------------------------------------------------------------------
2025-07-18 11:15:08.215 | INFO     | info                           | 
============================================================
2025-07-18 11:15:08.215 | INFO     | info                           | INITIALIZING SYMBIOTIC SWARM TEST
2025-07-18 11:15:08.215 | INFO     | info                           | ============================================================

2025-07-18 11:15:08.215 | INFO     | info                           | Loading 'bbbp' dataset...
2025-07-18 11:15:08.216 | INFO     | info                           | Loading bbbp from MoleculeNet...
2025-07-18 11:15:08.216 | INFO     | info                           | Successfully initialized RDKit MorganGenerator.
2025-07-18 11:15:08.216 | INFO     | info                           | Using RobustFeaturizer wrapping RDKit MorganGenerator.
2025-07-18 11:15:08.216 | INFO     | info                           | Using DeepChem data directory: deepchem_data
2025-07-18 11:15:08.217 | INFO     | info                           | Data directory exists: deepchem_data
2025-07-18 11:15:08.218 | WARNING  | warning                        | BBBP dataset directory not found: deepchem_data/bbbp
2025-07-18 11:15:08.238 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'O=N([O-])C1=C(CN=C1NCCSCc2ncccc2)Cc3ccccc3'. Returning zero vector.
2025-07-18 11:15:08.238 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'c1(nc(NC(N)=[NH2])sc1)CSCCNC(=[NH]C#N)NC'. Returning zero vector.
2025-07-18 11:15:08.278 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'Cc1nc(sc1)\[NH]=C(\N)N'. Returning zero vector.
2025-07-18 11:15:08.302 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 's1cc(CSCCN\C(NC)=[NH]\C#N)nc1\[NH]=C(\N)N'. Returning zero vector.
2025-07-18 11:15:08.307 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'c1c(c(ncc1)CSCCN\C(=[NH]\C#N)NCC)Br'. Returning zero vector.
2025-07-18 11:15:08.307 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'n1c(csc1\[NH]=C(\N)N)c1ccccc1'. Returning zero vector.
2025-07-18 11:15:08.308 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'n1c(csc1\[NH]=C(\N)N)c1cccc(c1)N'. Returning zero vector.
2025-07-18 11:15:08.308 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'n1c(csc1\[NH]=C(\N)N)c1cccc(c1)NC(C)=O'. Returning zero vector.
2025-07-18 11:15:08.309 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'n1c(csc1\[NH]=C(\N)N)c1cccc(c1)N\C(NC)=[NH]\C#N'. Returning zero vector.
2025-07-18 11:15:08.309 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 's1cc(nc1\[NH]=C(\N)N)C'. Returning zero vector.
2025-07-18 11:15:08.314 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'c1(cc(N\C(=[NH]\c2cccc(c2)CC)C)ccc1)CC'. Returning zero vector.
2025-07-18 11:15:08.534 | INFO     | info                           | Step 2: Filtering out invalid molecules before splitting...
2025-07-18 11:15:08.690 | WARNING  | warning                        | Removed 11 invalid SMILES strings before splitting.
2025-07-18 11:15:08.724 | INFO     | info                           | Step 3: Splitting the cleaned dataset...
2025-07-18 11:15:09.190 | INFO     | info                           | Step 4: Applying data transformations...
2025-07-18 11:15:09.205 | INFO     | info                           | Converting 1631 molecules from DeepChem
2025-07-18 11:15:17.635 | INFO     | info                           | Successfully converted 1631 molecules
2025-07-18 11:15:17.636 | INFO     | info                           | Converting 204 molecules from DeepChem
2025-07-18 11:15:18.006 | INFO     | info                           | Successfully converted 204 molecules
2025-07-18 11:15:18.007 | INFO     | info                           | Converting 204 molecules from DeepChem
2025-07-18 11:15:18.282 | INFO     | info                           | Successfully converted 204 molecules
2025-07-18 11:15:18.283 | INFO     | info                           | Successfully converted bbbp:
2025-07-18 11:15:18.283 | INFO     | info                           |   Train: 1631 antigens
2025-07-18 11:15:18.283 | INFO     | info                           |   Valid: 204 antigens
2025-07-18 11:15:18.283 | INFO     | info                           |   Test: 204 antigens
2025-07-18 11:15:18.284 | INFO     | info                           | Loaded 1631 training samples.
2025-07-18 11:15:18.285 | INFO     | info                           | üèùÔ∏è  Initializing Archipelago with 3 islands across devices: ['cuda:0', 'cuda:0', 'cuda:0']
2025-07-18 11:15:18.286 | INFO     | info                           |    Creating Island 1 on device cuda:0...
2025-07-18 11:15:18.603 | INFO     | info                           | GPU Memory: 0.00/24.00 GB (0.0%)
2025-07-18 11:15:18.603 | INFO     | info                           | 
üß¨ Initializing production population with 64 cells...
2025-07-18 11:15:18.603 | INFO     | info                           |    Creating 12 dedicated stem cells...
2025-07-18 11:15:19.007 | INFO     | info                           |    Creating 52 mixed-type cells...
2025-07-18 11:15:19.103 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:19.143 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:19.610 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:20.176 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:20.248 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:20.285 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:20.315 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:20.445 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:20.897 | INFO     | info                           |    Created 50/52 mixed cells...
2025-07-18 11:15:20.957 | INFO     | info                           | ‚úÖ‚úÖ  Population initialized with 64 cells (12 stem cells + 52 mixed)  ‚úÖ‚úÖ 
2025-07-18 11:15:20.983 | INFO     | info                           |    Creating Island 2 on device cuda:0...
2025-07-18 11:15:20.993 | INFO     | info                           | GPU Memory: 1.77/24.00 GB (7.4%)
2025-07-18 11:15:20.993 | INFO     | info                           | 
üß¨ Initializing production population with 64 cells...
2025-07-18 11:15:20.993 | INFO     | info                           |    Creating 12 dedicated stem cells...
2025-07-18 11:15:21.371 | INFO     | info                           |    Creating 52 mixed-type cells...
2025-07-18 11:15:21.467 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:21.501 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:21.969 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:22.244 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:22.309 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:22.342 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:22.374 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:22.493 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:22.903 | INFO     | info                           |    Created 50/52 mixed cells...
2025-07-18 11:15:22.960 | INFO     | info                           | ‚úÖ‚úÖ  Population initialized with 64 cells (12 stem cells + 52 mixed)  ‚úÖ‚úÖ 
2025-07-18 11:15:22.960 | INFO     | info                           |    Creating Island 3 on device cuda:0...
2025-07-18 11:15:22.968 | INFO     | info                           | GPU Memory: 3.54/24.00 GB (14.8%)
2025-07-18 11:15:22.968 | INFO     | info                           | 
üß¨ Initializing production population with 64 cells...
2025-07-18 11:15:22.968 | INFO     | info                           |    Creating 12 dedicated stem cells...
2025-07-18 11:15:23.337 | INFO     | info                           |    Creating 52 mixed-type cells...
2025-07-18 11:15:23.442 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:23.875 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:23.904 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:24.116 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:24.310 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:24.344 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:25.018 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:25.092 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:15:25.173 | INFO     | info                           |    Created 50/52 mixed cells...
2025-07-18 11:15:25.231 | INFO     | info                           | ‚úÖ‚úÖ  Population initialized with 64 cells (12 stem cells + 52 mixed)  ‚úÖ‚úÖ 
2025-07-18 11:15:25.232 | INFO     | info                           | 
--- Starting Cultivation Loop ---
2025-07-18 11:15:25.237 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 1 ==============================
2025-07-18 11:15:25.238 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:25.239 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:25.240 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:25.241 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:25.256 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.256 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.256 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.257 | INFO     | info                           | GENERATION 1
2025-07-18 11:15:25.257 | INFO     | info                           | GENERATION 1
2025-07-18 11:15:25.257 | INFO     | info                           | GENERATION 1
2025-07-18 11:15:25.257 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.257 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.257 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.274 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.274 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.274 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.569 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.575 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.581 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.581 | INFO     | info                           |    All islands have completed Generation 1.
2025-07-18 11:15:25.585 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 2 ==============================
2025-07-18 11:15:25.585 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:25.585 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:25.585 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:25.585 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:25.602 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.602 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.602 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.602 | INFO     | info                           | GENERATION 2
2025-07-18 11:15:25.602 | INFO     | info                           | GENERATION 2
2025-07-18 11:15:25.602 | INFO     | info                           | GENERATION 2
2025-07-18 11:15:25.602 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.602 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.602 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.619 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.620 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.620 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.636 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.641 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.647 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.647 | INFO     | info                           |    All islands have completed Generation 2.
2025-07-18 11:15:25.651 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 3 ==============================
2025-07-18 11:15:25.651 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:25.652 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:25.652 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:25.652 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:25.669 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.669 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.669 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.669 | INFO     | info                           | GENERATION 3
2025-07-18 11:15:25.669 | INFO     | info                           | GENERATION 3
2025-07-18 11:15:25.669 | INFO     | info                           | GENERATION 3
2025-07-18 11:15:25.669 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.669 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.670 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.686 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.686 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.686 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.704 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.709 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.715 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.715 | INFO     | info                           |    All islands have completed Generation 3.
2025-07-18 11:15:25.719 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 4 ==============================
2025-07-18 11:15:25.719 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:25.720 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:25.720 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:25.720 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:25.735 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.735 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.735 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.735 | INFO     | info                           | GENERATION 4
2025-07-18 11:15:25.736 | INFO     | info                           | GENERATION 4
2025-07-18 11:15:25.736 | INFO     | info                           | GENERATION 4
2025-07-18 11:15:25.736 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.736 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.736 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.750 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.750 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.751 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.768 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.773 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.780 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.780 | INFO     | info                           |    All islands have completed Generation 4.
2025-07-18 11:15:25.784 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 5 ==============================
2025-07-18 11:15:25.784 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:25.785 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:25.785 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:25.785 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:25.801 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.801 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.801 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:25.801 | INFO     | info                           | GENERATION 5
2025-07-18 11:15:25.801 | INFO     | info                           | GENERATION 5
2025-07-18 11:15:25.801 | INFO     | info                           | GENERATION 5
2025-07-18 11:15:25.801 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.802 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.802 | INFO     | info                           | ================================================================================
2025-07-18 11:15:25.817 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.818 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.818 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:25.833 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.839 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.845 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:25.845 | INFO     | info                           |    All islands have completed Generation 5.
2025-07-18 11:15:25.845 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 5 ‚õµ
2025-07-18 11:15:25.845 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:25.845 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:25.846 | INFO     | info                           |    Island 3 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:26.128 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:15:26.364 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:15:26.580 | INFO     | info                           |    Island 3 (on cuda:0) received 5 new cells.
2025-07-18 11:15:26.584 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 6 ==============================
2025-07-18 11:15:26.584 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:26.585 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:26.585 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:26.585 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:26.606 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.606 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.606 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.606 | INFO     | info                           | GENERATION 6
2025-07-18 11:15:26.606 | INFO     | info                           | GENERATION 6
2025-07-18 11:15:26.606 | INFO     | info                           | GENERATION 6
2025-07-18 11:15:26.607 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.607 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.607 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.633 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.633 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.633 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.651 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.656 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.662 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.662 | INFO     | info                           |    All islands have completed Generation 6.
2025-07-18 11:15:26.666 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 7 ==============================
2025-07-18 11:15:26.666 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:26.666 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:26.667 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:26.667 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:26.682 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.682 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.682 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.682 | INFO     | info                           | GENERATION 7
2025-07-18 11:15:26.682 | INFO     | info                           | GENERATION 7
2025-07-18 11:15:26.682 | INFO     | info                           | GENERATION 7
2025-07-18 11:15:26.682 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.682 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.682 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.710 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.710 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.710 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.728 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.734 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.740 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.741 | INFO     | info                           |    All islands have completed Generation 7.
2025-07-18 11:15:26.747 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 8 ==============================
2025-07-18 11:15:26.747 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:26.747 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:26.747 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:26.748 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:26.762 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.763 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.763 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.763 | INFO     | info                           | GENERATION 8
2025-07-18 11:15:26.763 | INFO     | info                           | GENERATION 8
2025-07-18 11:15:26.763 | INFO     | info                           | GENERATION 8
2025-07-18 11:15:26.764 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.764 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.764 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.790 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.790 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.790 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.809 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.816 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.823 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.823 | INFO     | info                           |    All islands have completed Generation 8.
2025-07-18 11:15:26.827 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 9 ==============================
2025-07-18 11:15:26.827 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:26.827 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:26.828 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:26.828 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:26.848 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.848 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.848 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.848 | INFO     | info                           | GENERATION 9
2025-07-18 11:15:26.848 | INFO     | info                           | GENERATION 9
2025-07-18 11:15:26.848 | INFO     | info                           | GENERATION 9
2025-07-18 11:15:26.848 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.848 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.848 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.874 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.874 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.874 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.894 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.900 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.906 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.907 | INFO     | info                           |    All islands have completed Generation 9.
2025-07-18 11:15:26.910 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 10 ==============================
2025-07-18 11:15:26.910 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:26.911 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:26.911 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:26.911 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:26.927 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.927 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.928 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:26.928 | INFO     | info                           | GENERATION 10
2025-07-18 11:15:26.928 | INFO     | info                           | GENERATION 10
2025-07-18 11:15:26.928 | INFO     | info                           | GENERATION 10
2025-07-18 11:15:26.928 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.928 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.928 | INFO     | info                           | ================================================================================
2025-07-18 11:15:26.955 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.955 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.955 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:26.976 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.982 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.988 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:26.988 | INFO     | info                           |    All islands have completed Generation 10.
2025-07-18 11:15:26.988 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 10 ‚õµ
2025-07-18 11:15:26.989 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:26.989 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:26.989 | INFO     | info                           |    Island 3 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:27.229 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:15:27.478 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:15:27.694 | INFO     | info                           |    Island 3 (on cuda:0) received 5 new cells.
2025-07-18 11:15:27.698 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 11 ==============================
2025-07-18 11:15:27.699 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:27.699 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:27.699 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:27.700 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:27.719 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:27.719 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:27.719 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:27.719 | INFO     | info                           | GENERATION 11
2025-07-18 11:15:27.720 | INFO     | info                           | GENERATION 11
2025-07-18 11:15:27.720 | INFO     | info                           | GENERATION 11
2025-07-18 11:15:27.720 | INFO     | info                           | ================================================================================
2025-07-18 11:15:27.720 | INFO     | info                           | ================================================================================
2025-07-18 11:15:27.721 | INFO     | info                           | ================================================================================
2025-07-18 11:15:27.744 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:27.745 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:27.745 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:27.756 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:27.762 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:27.768 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:27.768 | INFO     | info                           |    All islands have completed Generation 11.
2025-07-18 11:15:27.772 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 12 ==============================
2025-07-18 11:15:27.772 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:27.772 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:27.777 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:27.777 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:27.791 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:27.791 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:27.791 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:27.791 | INFO     | info                           | GENERATION 12
2025-07-18 11:15:27.792 | INFO     | info                           | GENERATION 12
2025-07-18 11:15:27.792 | INFO     | info                           | GENERATION 12
2025-07-18 11:15:27.792 | INFO     | info                           | ================================================================================
2025-07-18 11:15:27.792 | INFO     | info                           | ================================================================================
2025-07-18 11:15:27.792 | INFO     | info                           | ================================================================================
2025-07-18 11:15:27.814 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:27.814 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:27.814 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:27.832 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:27.838 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:27.844 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:27.845 | INFO     | info                           |    All islands have completed Generation 12.
2025-07-18 11:15:27.848 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 13 ==============================
2025-07-18 11:15:27.849 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:27.849 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:27.849 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:27.849 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:27.871 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:27.871 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:27.872 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:27.872 | INFO     | info                           | GENERATION 13
2025-07-18 11:15:27.872 | INFO     | info                           | GENERATION 13
2025-07-18 11:15:27.872 | INFO     | info                           | GENERATION 13
2025-07-18 11:15:27.872 | INFO     | info                           | ================================================================================
2025-07-18 11:15:27.872 | INFO     | info                           | ================================================================================
2025-07-18 11:15:27.872 | INFO     | info                           | ================================================================================
2025-07-18 11:15:27.899 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:27.899 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:27.899 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:27.917 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:27.923 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:27.929 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:27.930 | INFO     | info                           |    All islands have completed Generation 13.
2025-07-18 11:15:27.933 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 14 ==============================
2025-07-18 11:15:27.934 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:27.934 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:27.934 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:27.934 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:27.958 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:27.959 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:27.959 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:27.959 | INFO     | info                           | GENERATION 14
2025-07-18 11:15:27.959 | INFO     | info                           | GENERATION 14
2025-07-18 11:15:27.959 | INFO     | info                           | GENERATION 14
2025-07-18 11:15:27.959 | INFO     | info                           | ================================================================================
2025-07-18 11:15:27.959 | INFO     | info                           | ================================================================================
2025-07-18 11:15:27.959 | INFO     | info                           | ================================================================================
2025-07-18 11:15:27.989 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:27.989 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:27.989 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:28.011 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:28.018 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:28.024 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:28.025 | INFO     | info                           |    All islands have completed Generation 14.
2025-07-18 11:15:28.028 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 15 ==============================
2025-07-18 11:15:28.029 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:28.029 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:28.031 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:28.031 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:28.046 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:28.046 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:28.046 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:28.046 | INFO     | info                           | GENERATION 15
2025-07-18 11:15:28.046 | INFO     | info                           | GENERATION 15
2025-07-18 11:15:28.047 | INFO     | info                           | GENERATION 15
2025-07-18 11:15:28.047 | INFO     | info                           | ================================================================================
2025-07-18 11:15:28.047 | INFO     | info                           | ================================================================================
2025-07-18 11:15:28.047 | INFO     | info                           | ================================================================================
2025-07-18 11:15:28.073 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:28.073 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:28.073 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:28.090 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:28.096 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:28.102 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:28.102 | INFO     | info                           |    All islands have completed Generation 15.
2025-07-18 11:15:28.103 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 15 ‚õµ
2025-07-18 11:15:28.103 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:28.103 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:28.103 | INFO     | info                           |    Island 3 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:28.329 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:15:28.564 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:15:28.788 | INFO     | info                           |    Island 3 (on cuda:0) received 5 new cells.
2025-07-18 11:15:28.792 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 16 ==============================
2025-07-18 11:15:28.792 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:28.793 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:28.793 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:28.793 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:28.810 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:28.810 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:28.810 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:28.810 | INFO     | info                           | GENERATION 16
2025-07-18 11:15:28.811 | INFO     | info                           | GENERATION 16
2025-07-18 11:15:28.811 | INFO     | info                           | GENERATION 16
2025-07-18 11:15:28.811 | INFO     | info                           | ================================================================================
2025-07-18 11:15:28.811 | INFO     | info                           | ================================================================================
2025-07-18 11:15:28.811 | INFO     | info                           | ================================================================================
2025-07-18 11:15:28.837 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:28.837 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:28.838 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:28.855 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:28.861 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:28.867 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:28.868 | INFO     | info                           |    All islands have completed Generation 16.
2025-07-18 11:15:28.872 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 17 ==============================
2025-07-18 11:15:28.872 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:28.872 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:28.872 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:28.872 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:28.893 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:28.893 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:28.893 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:28.893 | INFO     | info                           | GENERATION 17
2025-07-18 11:15:28.893 | INFO     | info                           | GENERATION 17
2025-07-18 11:15:28.894 | INFO     | info                           | GENERATION 17
2025-07-18 11:15:28.894 | INFO     | info                           | ================================================================================
2025-07-18 11:15:28.894 | INFO     | info                           | ================================================================================
2025-07-18 11:15:28.894 | INFO     | info                           | ================================================================================
2025-07-18 11:15:28.920 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:28.920 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:28.920 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:28.936 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:28.942 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:28.948 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:28.948 | INFO     | info                           |    All islands have completed Generation 17.
2025-07-18 11:15:28.953 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 18 ==============================
2025-07-18 11:15:28.953 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:28.953 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:28.953 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:28.953 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:28.969 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:28.969 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:28.969 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:28.969 | INFO     | info                           | GENERATION 18
2025-07-18 11:15:28.969 | INFO     | info                           | GENERATION 18
2025-07-18 11:15:28.969 | INFO     | info                           | GENERATION 18
2025-07-18 11:15:28.969 | INFO     | info                           | ================================================================================
2025-07-18 11:15:28.970 | INFO     | info                           | ================================================================================
2025-07-18 11:15:28.970 | INFO     | info                           | ================================================================================
2025-07-18 11:15:28.995 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:28.995 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:28.995 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:29.006 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:29.012 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:29.019 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:29.019 | INFO     | info                           |    All islands have completed Generation 18.
2025-07-18 11:15:29.022 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 19 ==============================
2025-07-18 11:15:29.023 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:29.023 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:29.023 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:29.023 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:29.041 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:29.041 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:29.041 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:29.041 | INFO     | info                           | GENERATION 19
2025-07-18 11:15:29.041 | INFO     | info                           | GENERATION 19
2025-07-18 11:15:29.042 | INFO     | info                           | GENERATION 19
2025-07-18 11:15:29.042 | INFO     | info                           | ================================================================================
2025-07-18 11:15:29.042 | INFO     | info                           | ================================================================================
2025-07-18 11:15:29.042 | INFO     | info                           | ================================================================================
2025-07-18 11:15:29.069 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:29.069 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:29.069 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:29.079 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:29.085 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:29.090 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:29.090 | INFO     | info                           |    All islands have completed Generation 19.
2025-07-18 11:15:29.094 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 20 ==============================
2025-07-18 11:15:29.094 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:29.095 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:29.095 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:29.095 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:29.110 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:29.110 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:29.110 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:29.111 | INFO     | info                           | GENERATION 20
2025-07-18 11:15:29.111 | INFO     | info                           | GENERATION 20
2025-07-18 11:15:29.111 | INFO     | info                           | GENERATION 20
2025-07-18 11:15:29.111 | INFO     | info                           | ================================================================================
2025-07-18 11:15:29.111 | INFO     | info                           | ================================================================================
2025-07-18 11:15:29.113 | INFO     | info                           | ================================================================================
2025-07-18 11:15:29.140 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:29.141 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:29.141 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:29.158 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:29.164 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:29.170 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:29.170 | INFO     | info                           |    All islands have completed Generation 20.
2025-07-18 11:15:29.170 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 20 ‚õµ
2025-07-18 11:15:29.171 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:29.171 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:29.171 | INFO     | info                           |    Island 3 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:29.429 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:15:29.711 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:15:29.970 | INFO     | info                           |    Island 3 (on cuda:0) received 5 new cells.
2025-07-18 11:15:29.974 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 21 ==============================
2025-07-18 11:15:29.975 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:29.975 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:29.975 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:29.976 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:30.000 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.000 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.000 | INFO     | info                           | GENERATION 21
2025-07-18 11:15:30.001 | INFO     | info                           | GENERATION 21
2025-07-18 11:15:30.001 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.001 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.002 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.002 | INFO     | info                           | GENERATION 21
2025-07-18 11:15:30.003 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.032 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.032 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.032 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.049 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.055 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.061 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.061 | INFO     | info                           |    All islands have completed Generation 21.
2025-07-18 11:15:30.065 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 22 ==============================
2025-07-18 11:15:30.066 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:30.066 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:30.066 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:30.066 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:30.085 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.085 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.085 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.085 | INFO     | info                           | GENERATION 22
2025-07-18 11:15:30.085 | INFO     | info                           | GENERATION 22
2025-07-18 11:15:30.085 | INFO     | info                           | GENERATION 22
2025-07-18 11:15:30.085 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.085 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.086 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.114 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.114 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.114 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.132 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.138 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.144 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.144 | INFO     | info                           |    All islands have completed Generation 22.
2025-07-18 11:15:30.148 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 23 ==============================
2025-07-18 11:15:30.149 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:30.149 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:30.149 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:30.149 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:30.165 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.165 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.165 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.165 | INFO     | info                           | GENERATION 23
2025-07-18 11:15:30.165 | INFO     | info                           | GENERATION 23
2025-07-18 11:15:30.165 | INFO     | info                           | GENERATION 23
2025-07-18 11:15:30.166 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.166 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.166 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.191 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.191 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.191 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.209 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.215 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.221 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.221 | INFO     | info                           |    All islands have completed Generation 23.
2025-07-18 11:15:30.224 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 24 ==============================
2025-07-18 11:15:30.224 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:30.225 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:30.225 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:30.225 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:30.243 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.243 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.243 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.244 | INFO     | info                           | GENERATION 24
2025-07-18 11:15:30.244 | INFO     | info                           | GENERATION 24
2025-07-18 11:15:30.244 | INFO     | info                           | GENERATION 24
2025-07-18 11:15:30.244 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.244 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.244 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.270 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.270 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.270 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.288 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.294 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.300 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.300 | INFO     | info                           |    All islands have completed Generation 24.
2025-07-18 11:15:30.303 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 25 ==============================
2025-07-18 11:15:30.304 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:30.304 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:30.304 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:30.304 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:30.321 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.321 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.321 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:30.322 | INFO     | info                           | GENERATION 25
2025-07-18 11:15:30.322 | INFO     | info                           | GENERATION 25
2025-07-18 11:15:30.322 | INFO     | info                           | GENERATION 25
2025-07-18 11:15:30.322 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.322 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.323 | INFO     | info                           | ================================================================================
2025-07-18 11:15:30.349 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.349 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.349 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:30.375 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.381 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.386 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:30.386 | INFO     | info                           |    All islands have completed Generation 25.
2025-07-18 11:15:30.386 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 25 ‚õµ
2025-07-18 11:15:30.387 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:30.387 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:30.387 | INFO     | info                           |    Island 3 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:30.626 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:15:30.862 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:15:31.099 | INFO     | info                           |    Island 3 (on cuda:0) received 5 new cells.
2025-07-18 11:15:31.106 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 26 ==============================
2025-07-18 11:15:31.106 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:31.106 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:31.109 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:31.109 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:31.123 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.123 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.123 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.123 | INFO     | info                           | GENERATION 26
2025-07-18 11:15:31.123 | INFO     | info                           | GENERATION 26
2025-07-18 11:15:31.123 | INFO     | info                           | GENERATION 26
2025-07-18 11:15:31.123 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.124 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.124 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.148 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.148 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.148 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.166 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.172 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.178 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.178 | INFO     | info                           |    All islands have completed Generation 26.
2025-07-18 11:15:31.182 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 27 ==============================
2025-07-18 11:15:31.182 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:31.182 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:31.182 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:31.182 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:31.198 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.198 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.198 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.198 | INFO     | info                           | GENERATION 27
2025-07-18 11:15:31.199 | INFO     | info                           | GENERATION 27
2025-07-18 11:15:31.199 | INFO     | info                           | GENERATION 27
2025-07-18 11:15:31.199 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.199 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.199 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.226 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.226 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.226 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.243 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.249 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.254 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.254 | INFO     | info                           |    All islands have completed Generation 27.
2025-07-18 11:15:31.258 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 28 ==============================
2025-07-18 11:15:31.258 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:31.259 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:31.259 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:31.261 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:31.278 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.278 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.278 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.279 | INFO     | info                           | GENERATION 28
2025-07-18 11:15:31.279 | INFO     | info                           | GENERATION 28
2025-07-18 11:15:31.279 | INFO     | info                           | GENERATION 28
2025-07-18 11:15:31.279 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.279 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.279 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.308 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.308 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.308 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.325 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.331 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.337 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.337 | INFO     | info                           |    All islands have completed Generation 28.
2025-07-18 11:15:31.341 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 29 ==============================
2025-07-18 11:15:31.341 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:31.341 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:31.341 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:31.341 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:31.359 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.359 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.359 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.359 | INFO     | info                           | GENERATION 29
2025-07-18 11:15:31.359 | INFO     | info                           | GENERATION 29
2025-07-18 11:15:31.359 | INFO     | info                           | GENERATION 29
2025-07-18 11:15:31.359 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.359 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.360 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.387 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.387 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.387 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.403 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.409 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.415 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.415 | INFO     | info                           |    All islands have completed Generation 29.
2025-07-18 11:15:31.420 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 30 ==============================
2025-07-18 11:15:31.420 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:15:31.420 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:15:31.421 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:0...
2025-07-18 11:15:31.421 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:15:31.440 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.440 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.440 | INFO     | info                           | 
================================================================================
2025-07-18 11:15:31.440 | INFO     | info                           | GENERATION 30
2025-07-18 11:15:31.441 | INFO     | info                           | GENERATION 30
2025-07-18 11:15:31.441 | INFO     | info                           | GENERATION 30
2025-07-18 11:15:31.441 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.441 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.441 | INFO     | info                           | ================================================================================
2025-07-18 11:15:31.469 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.469 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.469 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:15:31.479 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.485 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.491 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:15:31.491 | INFO     | info                           |    All islands have completed Generation 30.
2025-07-18 11:15:31.491 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 30 ‚õµ
2025-07-18 11:15:31.491 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:31.491 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:31.491 | INFO     | info                           |    Island 3 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:15:31.770 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:15:32.018 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:15:32.542 | INFO     | info                           |    Island 3 (on cuda:0) received 5 new cells.
2025-07-18 11:15:32.542 | INFO     | info                           | 
--- Cultivation Complete ---
2025-07-18 11:15:32.543 | INFO     | info                           | Total time for 30 generations: 7.31 seconds.

2025-07-18 11:11:24.767 | INFO     | __init__                       | ================================================================================
2025-07-18 11:11:24.768 | INFO     | __init__                       | TE-AI RUN INITIALIZED: 20250718_111124
2025-07-18 11:11:24.768 | INFO     | __init__                       | Log file: logs/te_ai_run_20250718_111124.log
2025-07-18 11:11:24.768 | INFO     | __init__                       | Max file size: 50.0 MB
2025-07-18 11:11:24.768 | INFO     | __init__                       | Backup files: 10
2025-07-18 11:11:24.768 | INFO     | __init__                       | ================================================================================
2025-07-18 11:11:24.768 | INFO     | _log_system_info               | SYSTEM INFORMATION:
2025-07-18 11:11:24.769 | INFO     | _log_system_info               |   Python version: 3.12.8 | packaged by Anaconda, Inc. | (main, Dec 11 2024, 16:31:09) [GCC 11.2.0]
2025-07-18 11:11:24.769 | INFO     | _log_system_info               |   PyTorch version: 2.7.1+cu126
2025-07-18 11:11:24.769 | INFO     | _log_system_info               |   CUDA available: True
2025-07-18 11:11:24.798 | INFO     | _log_system_info               |   CUDA device: NVIDIA GeForce RTX 3090
2025-07-18 11:11:24.798 | INFO     | _log_system_info               |   CUDA memory: 25.77 GB
2025-07-18 11:11:24.798 | INFO     | _log_system_info               | --------------------------------------------------------------------------------
2025-07-18 11:12:08.029 | INFO     | info                           | 
============================================================
2025-07-18 11:12:08.029 | INFO     | info                           | INITIALIZING SYMBIOTIC SWARM TEST
2025-07-18 11:12:08.029 | INFO     | info                           | ============================================================

2025-07-18 11:12:08.029 | INFO     | info                           | Loading 'bbbp' dataset...
2025-07-18 11:12:08.029 | INFO     | info                           | Loading bbbp from MoleculeNet...
2025-07-18 11:12:08.030 | INFO     | info                           | Successfully initialized RDKit MorganGenerator.
2025-07-18 11:12:08.030 | INFO     | info                           | Using RobustFeaturizer wrapping RDKit MorganGenerator.
2025-07-18 11:12:08.030 | INFO     | info                           | Using DeepChem data directory: deepchem_data
2025-07-18 11:12:08.031 | INFO     | info                           | Data directory exists: deepchem_data
2025-07-18 11:12:08.031 | WARNING  | warning                        | BBBP dataset directory not found: deepchem_data/bbbp
2025-07-18 11:12:08.053 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'O=N([O-])C1=C(CN=C1NCCSCc2ncccc2)Cc3ccccc3'. Returning zero vector.
2025-07-18 11:12:08.054 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'c1(nc(NC(N)=[NH2])sc1)CSCCNC(=[NH]C#N)NC'. Returning zero vector.
2025-07-18 11:12:08.093 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'Cc1nc(sc1)\[NH]=C(\N)N'. Returning zero vector.
2025-07-18 11:12:08.117 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 's1cc(CSCCN\C(NC)=[NH]\C#N)nc1\[NH]=C(\N)N'. Returning zero vector.
2025-07-18 11:12:08.121 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'c1c(c(ncc1)CSCCN\C(=[NH]\C#N)NCC)Br'. Returning zero vector.
2025-07-18 11:12:08.122 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'n1c(csc1\[NH]=C(\N)N)c1ccccc1'. Returning zero vector.
2025-07-18 11:12:08.122 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'n1c(csc1\[NH]=C(\N)N)c1cccc(c1)N'. Returning zero vector.
2025-07-18 11:12:08.123 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'n1c(csc1\[NH]=C(\N)N)c1cccc(c1)NC(C)=O'. Returning zero vector.
2025-07-18 11:12:08.123 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'n1c(csc1\[NH]=C(\N)N)c1cccc(c1)N\C(NC)=[NH]\C#N'. Returning zero vector.
2025-07-18 11:12:08.124 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 's1cc(nc1\[NH]=C(\N)N)C'. Returning zero vector.
2025-07-18 11:12:08.128 | WARNING  | warning                        | Could not create a valid molecule from datapoint: 'c1(cc(N\C(=[NH]\c2cccc(c2)CC)C)ccc1)CC'. Returning zero vector.
2025-07-18 11:12:08.334 | INFO     | info                           | Step 2: Filtering out invalid molecules before splitting...
2025-07-18 11:12:08.494 | WARNING  | warning                        | Removed 11 invalid SMILES strings before splitting.
2025-07-18 11:12:08.521 | INFO     | info                           | Step 3: Splitting the cleaned dataset...
2025-07-18 11:12:08.998 | INFO     | info                           | Step 4: Applying data transformations...
2025-07-18 11:12:09.014 | INFO     | info                           | Converting 1631 molecules from DeepChem
2025-07-18 11:12:16.790 | INFO     | info                           | Successfully converted 1631 molecules
2025-07-18 11:12:16.791 | INFO     | info                           | Converting 204 molecules from DeepChem
2025-07-18 11:12:17.743 | INFO     | info                           | Successfully converted 204 molecules
2025-07-18 11:12:17.747 | INFO     | info                           | Converting 204 molecules from DeepChem
2025-07-18 11:12:18.041 | INFO     | info                           | Successfully converted 204 molecules
2025-07-18 11:12:18.042 | INFO     | info                           | Successfully converted bbbp:
2025-07-18 11:12:18.042 | INFO     | info                           |   Train: 1631 antigens
2025-07-18 11:12:18.042 | INFO     | info                           |   Valid: 204 antigens
2025-07-18 11:12:18.042 | INFO     | info                           |   Test: 204 antigens
2025-07-18 11:12:18.044 | INFO     | info                           | Loaded 1631 training samples.
2025-07-18 11:12:18.044 | INFO     | info                           | üèùÔ∏è  Initializing Archipelago with 3 islands across devices: ['cuda:0', 'cuda:0', 'cuda:1']
2025-07-18 11:12:18.044 | INFO     | info                           |    Creating Island 1 on device cuda:0...
2025-07-18 11:12:18.298 | INFO     | info                           | GPU Memory: 0.00/24.00 GB (0.0%)
2025-07-18 11:12:18.298 | INFO     | info                           | 
üß¨ Initializing production population with 64 cells...
2025-07-18 11:12:18.299 | INFO     | info                           |    Creating 12 dedicated stem cells...
2025-07-18 11:12:18.682 | INFO     | info                           |    Creating 52 mixed-type cells...
2025-07-18 11:12:18.778 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:18.814 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:19.296 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:19.833 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:19.897 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:19.929 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:19.958 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:20.079 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:20.482 | INFO     | info                           |    Created 50/52 mixed cells...
2025-07-18 11:12:20.540 | INFO     | info                           | ‚úÖ‚úÖ  Population initialized with 64 cells (12 stem cells + 52 mixed)  ‚úÖ‚úÖ 
2025-07-18 11:12:20.565 | INFO     | info                           |    Creating Island 2 on device cuda:0...
2025-07-18 11:12:20.573 | INFO     | info                           | GPU Memory: 1.77/24.00 GB (7.4%)
2025-07-18 11:12:20.573 | INFO     | info                           | 
üß¨ Initializing production population with 64 cells...
2025-07-18 11:12:20.573 | INFO     | info                           |    Creating 12 dedicated stem cells...
2025-07-18 11:12:20.937 | INFO     | info                           |    Creating 52 mixed-type cells...
2025-07-18 11:12:21.026 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:21.061 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:21.519 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:21.784 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:21.848 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:21.881 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:21.911 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:22.031 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:22.443 | INFO     | info                           |    Created 50/52 mixed cells...
2025-07-18 11:12:22.503 | INFO     | info                           | ‚úÖ‚úÖ  Population initialized with 64 cells (12 stem cells + 52 mixed)  ‚úÖ‚úÖ 
2025-07-18 11:12:22.503 | INFO     | info                           |    Creating Island 3 on device cuda:1...
2025-07-18 11:12:22.509 | INFO     | info                           | GPU Memory: 3.54/24.00 GB (14.8%)
2025-07-18 11:12:22.510 | INFO     | info                           | 
üß¨ Initializing production population with 64 cells...
2025-07-18 11:12:22.510 | INFO     | info                           |    Creating 12 dedicated stem cells...
2025-07-18 11:12:22.891 | INFO     | info                           |    Creating 52 mixed-type cells...
2025-07-18 11:12:22.978 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:23.381 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:23.408 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:23.618 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:23.801 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:23.836 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:24.505 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:24.591 | INFO     | info                           |    ‚ú®‚ú® A Quantum Gene has emerged!  ‚ú®‚ú®
2025-07-18 11:12:24.674 | INFO     | info                           |    Created 50/52 mixed cells...
2025-07-18 11:12:24.754 | INFO     | info                           | ‚úÖ‚úÖ  Population initialized with 64 cells (12 stem cells + 52 mixed)  ‚úÖ‚úÖ 
2025-07-18 11:12:24.754 | INFO     | info                           | 
--- Starting Cultivation Loop ---
2025-07-18 11:12:24.763 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 1 ==============================
2025-07-18 11:12:24.763 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:24.763 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:24.764 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:24.765 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:24.784 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:24.784 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:24.785 | INFO     | info                           | GENERATION 1
2025-07-18 11:12:24.785 | INFO     | info                           | GENERATION 1
2025-07-18 11:12:24.785 | INFO     | info                           | ================================================================================
2025-07-18 11:12:24.785 | INFO     | info                           | ================================================================================
2025-07-18 11:12:24.806 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:24.806 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:24.882 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:24.882 | INFO     | info                           | GENERATION 1
2025-07-18 11:12:24.882 | INFO     | info                           | ================================================================================
2025-07-18 11:12:24.888 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:25.193 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.200 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.207 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.207 | INFO     | info                           |    All islands have completed Generation 1.
2025-07-18 11:12:25.212 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 2 ==============================
2025-07-18 11:12:25.212 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:25.212 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:25.212 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:25.213 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:25.241 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:25.241 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:25.241 | INFO     | info                           | GENERATION 2
2025-07-18 11:12:25.242 | INFO     | info                           | GENERATION 2
2025-07-18 11:12:25.242 | INFO     | info                           | ================================================================================
2025-07-18 11:12:25.242 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:25.242 | INFO     | info                           | ================================================================================
2025-07-18 11:12:25.243 | INFO     | info                           | GENERATION 2
2025-07-18 11:12:25.243 | INFO     | info                           | ================================================================================
2025-07-18 11:12:25.261 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:25.261 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:25.261 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:25.277 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.283 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.289 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.289 | INFO     | info                           |    All islands have completed Generation 2.
2025-07-18 11:12:25.293 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 3 ==============================
2025-07-18 11:12:25.293 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:25.293 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:25.294 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:25.294 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:25.338 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:25.339 | INFO     | info                           | GENERATION 3
2025-07-18 11:12:25.339 | INFO     | info                           | ================================================================================
2025-07-18 11:12:25.340 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:25.341 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:25.341 | INFO     | info                           | GENERATION 3
2025-07-18 11:12:25.341 | INFO     | info                           | GENERATION 3
2025-07-18 11:12:25.341 | INFO     | info                           | ================================================================================
2025-07-18 11:12:25.341 | INFO     | info                           | ================================================================================
2025-07-18 11:12:25.369 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:25.369 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:25.369 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:25.380 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.386 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.391 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.392 | INFO     | info                           |    All islands have completed Generation 3.
2025-07-18 11:12:25.396 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 4 ==============================
2025-07-18 11:12:25.396 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:25.396 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:25.399 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:25.399 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:25.435 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:25.436 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:25.436 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:25.436 | INFO     | info                           | GENERATION 4
2025-07-18 11:12:25.437 | INFO     | info                           | GENERATION 4
2025-07-18 11:12:25.437 | INFO     | info                           | GENERATION 4
2025-07-18 11:12:25.437 | INFO     | info                           | ================================================================================
2025-07-18 11:12:25.437 | INFO     | info                           | ================================================================================
2025-07-18 11:12:25.437 | INFO     | info                           | ================================================================================
2025-07-18 11:12:25.464 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:25.465 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:25.465 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:25.480 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.485 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.491 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.491 | INFO     | info                           |    All islands have completed Generation 4.
2025-07-18 11:12:25.495 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 5 ==============================
2025-07-18 11:12:25.495 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:25.495 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:25.495 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:25.495 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:25.536 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:25.537 | INFO     | info                           | GENERATION 5
2025-07-18 11:12:25.537 | INFO     | info                           | ================================================================================
2025-07-18 11:12:25.540 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:25.540 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:25.540 | INFO     | info                           | GENERATION 5
2025-07-18 11:12:25.540 | INFO     | info                           | GENERATION 5
2025-07-18 11:12:25.541 | INFO     | info                           | ================================================================================
2025-07-18 11:12:25.541 | INFO     | info                           | ================================================================================
2025-07-18 11:12:25.567 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:25.567 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:25.567 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:25.582 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.587 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.593 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:25.593 | INFO     | info                           |    All islands have completed Generation 5.
2025-07-18 11:12:25.593 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 5 ‚õµ
2025-07-18 11:12:25.593 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:12:25.593 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:12:25.594 | INFO     | info                           |    Island 3 (on cuda:1) is sending its top 5 cells.
2025-07-18 11:12:25.866 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:12:26.088 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:12:26.399 | INFO     | info                           |    Island 3 (on cuda:1) received 5 new cells.
2025-07-18 11:12:26.403 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 6 ==============================
2025-07-18 11:12:26.403 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:26.403 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:26.404 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:26.404 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:26.446 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.447 | INFO     | info                           | GENERATION 6
2025-07-18 11:12:26.447 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.447 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.447 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.447 | INFO     | info                           | GENERATION 6
2025-07-18 11:12:26.448 | INFO     | info                           | GENERATION 6
2025-07-18 11:12:26.448 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.448 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.469 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.469 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.471 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.487 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.494 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.500 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.501 | INFO     | info                           |    All islands have completed Generation 6.
2025-07-18 11:12:26.504 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 7 ==============================
2025-07-18 11:12:26.504 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:26.504 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:26.505 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:26.505 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:26.541 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.542 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.542 | INFO     | info                           | GENERATION 7
2025-07-18 11:12:26.542 | INFO     | info                           | GENERATION 7
2025-07-18 11:12:26.543 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.543 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.546 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.546 | INFO     | info                           | GENERATION 7
2025-07-18 11:12:26.546 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.570 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.570 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.570 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.588 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.594 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.600 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.600 | INFO     | info                           |    All islands have completed Generation 7.
2025-07-18 11:12:26.604 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 8 ==============================
2025-07-18 11:12:26.604 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:26.605 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:26.611 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:26.612 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:26.637 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.637 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.637 | INFO     | info                           | GENERATION 8
2025-07-18 11:12:26.637 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.637 | INFO     | info                           | GENERATION 8
2025-07-18 11:12:26.637 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.638 | INFO     | info                           | GENERATION 8
2025-07-18 11:12:26.638 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.643 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.654 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.654 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.654 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.675 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.681 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.686 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.686 | INFO     | info                           |    All islands have completed Generation 8.
2025-07-18 11:12:26.690 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 9 ==============================
2025-07-18 11:12:26.690 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:26.691 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:26.691 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:26.691 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:26.726 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.726 | INFO     | info                           | GENERATION 9
2025-07-18 11:12:26.726 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.736 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.736 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.737 | INFO     | info                           | GENERATION 9
2025-07-18 11:12:26.737 | INFO     | info                           | GENERATION 9
2025-07-18 11:12:26.737 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.737 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.758 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.758 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.758 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.773 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.778 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.783 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.783 | INFO     | info                           |    All islands have completed Generation 9.
2025-07-18 11:12:26.787 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 10 ==============================
2025-07-18 11:12:26.787 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:26.787 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:26.791 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:26.791 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:26.825 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.825 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.825 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:26.825 | INFO     | info                           | GENERATION 10
2025-07-18 11:12:26.825 | INFO     | info                           | GENERATION 10
2025-07-18 11:12:26.826 | INFO     | info                           | GENERATION 10
2025-07-18 11:12:26.826 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.826 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.826 | INFO     | info                           | ================================================================================
2025-07-18 11:12:26.849 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.849 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.849 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:26.865 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.870 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.875 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:26.875 | INFO     | info                           |    All islands have completed Generation 10.
2025-07-18 11:12:26.876 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 10 ‚õµ
2025-07-18 11:12:26.876 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:12:26.876 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:12:26.876 | INFO     | info                           |    Island 3 (on cuda:1) is sending its top 5 cells.
2025-07-18 11:12:27.125 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:12:27.357 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:12:27.671 | INFO     | info                           |    Island 3 (on cuda:1) received 5 new cells.
2025-07-18 11:12:27.676 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 11 ==============================
2025-07-18 11:12:27.677 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:27.677 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:27.677 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:27.677 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:27.724 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:27.724 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:27.724 | INFO     | info                           | GENERATION 11
2025-07-18 11:12:27.724 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:27.724 | INFO     | info                           | GENERATION 11
2025-07-18 11:12:27.725 | INFO     | info                           | ================================================================================
2025-07-18 11:12:27.725 | INFO     | info                           | GENERATION 11
2025-07-18 11:12:27.725 | INFO     | info                           | ================================================================================
2025-07-18 11:12:27.725 | INFO     | info                           | ================================================================================
2025-07-18 11:12:27.741 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:27.741 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:27.741 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:27.757 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:27.762 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:27.767 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:27.767 | INFO     | info                           |    All islands have completed Generation 11.
2025-07-18 11:12:27.771 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 12 ==============================
2025-07-18 11:12:27.771 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:27.771 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:27.771 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:27.772 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:27.812 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:27.812 | INFO     | info                           | GENERATION 12
2025-07-18 11:12:27.813 | INFO     | info                           | ================================================================================
2025-07-18 11:12:27.813 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:27.814 | INFO     | info                           | GENERATION 12
2025-07-18 11:12:27.814 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:27.814 | INFO     | info                           | ================================================================================
2025-07-18 11:12:27.814 | INFO     | info                           | GENERATION 12
2025-07-18 11:12:27.814 | INFO     | info                           | ================================================================================
2025-07-18 11:12:27.841 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:27.842 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:27.842 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:27.857 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:27.862 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:27.867 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:27.867 | INFO     | info                           |    All islands have completed Generation 12.
2025-07-18 11:12:27.871 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 13 ==============================
2025-07-18 11:12:27.871 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:27.872 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:27.872 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:27.872 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:27.908 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:27.908 | INFO     | info                           | GENERATION 13
2025-07-18 11:12:27.908 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:27.909 | INFO     | info                           | ================================================================================
2025-07-18 11:12:27.909 | INFO     | info                           | GENERATION 13
2025-07-18 11:12:27.909 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:27.910 | INFO     | info                           | ================================================================================
2025-07-18 11:12:27.910 | INFO     | info                           | GENERATION 13
2025-07-18 11:12:27.910 | INFO     | info                           | ================================================================================
2025-07-18 11:12:27.937 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:27.937 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:27.937 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:27.953 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:27.958 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:27.963 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:27.963 | INFO     | info                           |    All islands have completed Generation 13.
2025-07-18 11:12:27.967 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 14 ==============================
2025-07-18 11:12:27.967 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:27.967 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:27.968 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:27.968 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:28.004 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:28.004 | INFO     | info                           | GENERATION 14
2025-07-18 11:12:28.005 | INFO     | info                           | ================================================================================
2025-07-18 11:12:28.007 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:28.007 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:28.007 | INFO     | info                           | GENERATION 14
2025-07-18 11:12:28.007 | INFO     | info                           | GENERATION 14
2025-07-18 11:12:28.008 | INFO     | info                           | ================================================================================
2025-07-18 11:12:28.008 | INFO     | info                           | ================================================================================
2025-07-18 11:12:28.030 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:28.030 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:28.030 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:28.046 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:28.053 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:28.059 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:28.059 | INFO     | info                           |    All islands have completed Generation 14.
2025-07-18 11:12:28.063 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 15 ==============================
2025-07-18 11:12:28.063 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:28.064 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:28.064 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:28.064 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:28.101 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:28.101 | INFO     | info                           | GENERATION 15
2025-07-18 11:12:28.101 | INFO     | info                           | ================================================================================
2025-07-18 11:12:28.111 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:28.111 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:28.115 | INFO     | info                           | GENERATION 15
2025-07-18 11:12:28.115 | INFO     | info                           | GENERATION 15
2025-07-18 11:12:28.115 | INFO     | info                           | ================================================================================
2025-07-18 11:12:28.115 | INFO     | info                           | ================================================================================
2025-07-18 11:12:28.128 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:28.128 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:28.128 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:28.144 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:28.150 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:28.156 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:28.156 | INFO     | info                           |    All islands have completed Generation 15.
2025-07-18 11:12:28.156 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 15 ‚õµ
2025-07-18 11:12:28.157 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:12:28.157 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:12:28.158 | INFO     | info                           |    Island 3 (on cuda:1) is sending its top 5 cells.
2025-07-18 11:12:28.410 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:12:28.665 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:12:28.958 | INFO     | info                           |    Island 3 (on cuda:1) received 5 new cells.
2025-07-18 11:12:28.962 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 16 ==============================
2025-07-18 11:12:28.962 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:28.963 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:28.963 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:28.963 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:29.009 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.009 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.009 | INFO     | info                           | GENERATION 16
2025-07-18 11:12:29.010 | INFO     | info                           | GENERATION 16
2025-07-18 11:12:29.010 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.015 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.015 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.015 | INFO     | info                           | GENERATION 16
2025-07-18 11:12:29.015 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.040 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.040 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.040 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.056 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.062 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.068 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.069 | INFO     | info                           |    All islands have completed Generation 16.
2025-07-18 11:12:29.073 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 17 ==============================
2025-07-18 11:12:29.073 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:29.073 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:29.073 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:29.073 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:29.104 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.105 | INFO     | info                           | GENERATION 17
2025-07-18 11:12:29.105 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.112 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.112 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.112 | INFO     | info                           | GENERATION 17
2025-07-18 11:12:29.112 | INFO     | info                           | GENERATION 17
2025-07-18 11:12:29.115 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.115 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.125 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.125 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.125 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.141 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.147 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.153 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.153 | INFO     | info                           |    All islands have completed Generation 17.
2025-07-18 11:12:29.158 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 18 ==============================
2025-07-18 11:12:29.158 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:29.158 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:29.158 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:29.158 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:29.195 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.196 | INFO     | info                           | GENERATION 18
2025-07-18 11:12:29.196 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.200 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.201 | INFO     | info                           | GENERATION 18
2025-07-18 11:12:29.201 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.202 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.202 | INFO     | info                           | GENERATION 18
2025-07-18 11:12:29.202 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.222 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.222 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.222 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.239 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.245 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.251 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.251 | INFO     | info                           |    All islands have completed Generation 18.
2025-07-18 11:12:29.255 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 19 ==============================
2025-07-18 11:12:29.255 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:29.255 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:29.256 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:29.256 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:29.290 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.291 | INFO     | info                           | GENERATION 19
2025-07-18 11:12:29.291 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.292 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.292 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.292 | INFO     | info                           | GENERATION 19
2025-07-18 11:12:29.293 | INFO     | info                           | GENERATION 19
2025-07-18 11:12:29.293 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.293 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.318 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.318 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.318 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.334 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.339 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.344 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.345 | INFO     | info                           |    All islands have completed Generation 19.
2025-07-18 11:12:29.348 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 20 ==============================
2025-07-18 11:12:29.348 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:29.348 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:29.349 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:29.349 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:29.387 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.387 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.387 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:29.388 | INFO     | info                           | GENERATION 20
2025-07-18 11:12:29.388 | INFO     | info                           | GENERATION 20
2025-07-18 11:12:29.388 | INFO     | info                           | GENERATION 20
2025-07-18 11:12:29.388 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.388 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.388 | INFO     | info                           | ================================================================================
2025-07-18 11:12:29.417 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.417 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.417 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:29.434 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.439 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.445 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:29.445 | INFO     | info                           |    All islands have completed Generation 20.
2025-07-18 11:12:29.445 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 20 ‚õµ
2025-07-18 11:12:29.445 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:12:29.446 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:12:29.446 | INFO     | info                           |    Island 3 (on cuda:1) is sending its top 5 cells.
2025-07-18 11:12:29.703 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:12:29.978 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:12:30.333 | INFO     | info                           |    Island 3 (on cuda:1) received 5 new cells.
2025-07-18 11:12:30.339 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 21 ==============================
2025-07-18 11:12:30.340 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:30.340 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:30.340 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:30.343 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:30.385 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.386 | INFO     | info                           | GENERATION 21
2025-07-18 11:12:30.386 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.388 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.389 | INFO     | info                           | GENERATION 21
2025-07-18 11:12:30.389 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.389 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.390 | INFO     | info                           | GENERATION 21
2025-07-18 11:12:30.390 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.415 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.418 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.420 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.445 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.451 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.458 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.458 | INFO     | info                           |    All islands have completed Generation 21.
2025-07-18 11:12:30.462 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 22 ==============================
2025-07-18 11:12:30.462 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:30.462 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:30.462 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:30.463 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:30.504 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.505 | INFO     | info                           | GENERATION 22
2025-07-18 11:12:30.505 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.514 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.515 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.515 | INFO     | info                           | GENERATION 22
2025-07-18 11:12:30.515 | INFO     | info                           | GENERATION 22
2025-07-18 11:12:30.515 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.515 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.535 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.535 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.535 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.560 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.573 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.583 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.583 | INFO     | info                           |    All islands have completed Generation 22.
2025-07-18 11:12:30.587 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 23 ==============================
2025-07-18 11:12:30.587 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:30.587 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:30.587 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:30.588 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:30.625 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.625 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.625 | INFO     | info                           | GENERATION 23
2025-07-18 11:12:30.625 | INFO     | info                           | GENERATION 23
2025-07-18 11:12:30.625 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.625 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.626 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.626 | INFO     | info                           | GENERATION 23
2025-07-18 11:12:30.626 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.651 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.651 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.651 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.668 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.674 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.679 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.679 | INFO     | info                           |    All islands have completed Generation 23.
2025-07-18 11:12:30.683 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 24 ==============================
2025-07-18 11:12:30.683 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:30.683 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:30.684 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:30.684 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:30.721 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.721 | INFO     | info                           | GENERATION 24
2025-07-18 11:12:30.721 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.723 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.723 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.724 | INFO     | info                           | GENERATION 24
2025-07-18 11:12:30.724 | INFO     | info                           | GENERATION 24
2025-07-18 11:12:30.724 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.724 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.747 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.747 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.747 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.763 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.769 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.774 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.774 | INFO     | info                           |    All islands have completed Generation 24.
2025-07-18 11:12:30.778 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 25 ==============================
2025-07-18 11:12:30.778 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:30.778 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:30.778 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:30.778 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:30.810 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.810 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.811 | INFO     | info                           | GENERATION 25
2025-07-18 11:12:30.811 | INFO     | info                           | GENERATION 25
2025-07-18 11:12:30.811 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.811 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.824 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:30.824 | INFO     | info                           | GENERATION 25
2025-07-18 11:12:30.824 | INFO     | info                           | ================================================================================
2025-07-18 11:12:30.832 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.832 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.832 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:30.847 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.855 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.860 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:30.860 | INFO     | info                           |    All islands have completed Generation 25.
2025-07-18 11:12:30.860 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 25 ‚õµ
2025-07-18 11:12:30.861 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:12:30.861 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:12:30.861 | INFO     | info                           |    Island 3 (on cuda:1) is sending its top 5 cells.
2025-07-18 11:12:31.119 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:12:31.375 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:12:31.705 | INFO     | info                           |    Island 3 (on cuda:1) received 5 new cells.
2025-07-18 11:12:31.710 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 26 ==============================
2025-07-18 11:12:31.710 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:31.710 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:31.710 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:31.710 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:31.757 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:31.758 | INFO     | info                           | GENERATION 26
2025-07-18 11:12:31.758 | INFO     | info                           | ================================================================================
2025-07-18 11:12:31.763 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:31.763 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:31.763 | INFO     | info                           | GENERATION 26
2025-07-18 11:12:31.764 | INFO     | info                           | GENERATION 26
2025-07-18 11:12:31.764 | INFO     | info                           | ================================================================================
2025-07-18 11:12:31.764 | INFO     | info                           | ================================================================================
2025-07-18 11:12:31.786 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:31.786 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:31.786 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:31.803 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:31.807 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:31.811 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:31.812 | INFO     | info                           |    All islands have completed Generation 26.
2025-07-18 11:12:31.815 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 27 ==============================
2025-07-18 11:12:31.815 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:31.816 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:31.816 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:31.816 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:31.856 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:31.856 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:31.856 | INFO     | info                           | GENERATION 27
2025-07-18 11:12:31.856 | INFO     | info                           | GENERATION 27
2025-07-18 11:12:31.856 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:31.856 | INFO     | info                           | ================================================================================
2025-07-18 11:12:31.856 | INFO     | info                           | ================================================================================
2025-07-18 11:12:31.857 | INFO     | info                           | GENERATION 27
2025-07-18 11:12:31.857 | INFO     | info                           | ================================================================================
2025-07-18 11:12:31.882 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:31.882 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:31.882 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:31.897 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:31.902 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:31.907 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:31.907 | INFO     | info                           |    All islands have completed Generation 27.
2025-07-18 11:12:31.911 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 28 ==============================
2025-07-18 11:12:31.911 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:31.912 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:31.912 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:31.912 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:31.950 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:31.951 | INFO     | info                           | GENERATION 28
2025-07-18 11:12:31.951 | INFO     | info                           | ================================================================================
2025-07-18 11:12:31.953 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:31.953 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:31.953 | INFO     | info                           | GENERATION 28
2025-07-18 11:12:31.953 | INFO     | info                           | GENERATION 28
2025-07-18 11:12:31.954 | INFO     | info                           | ================================================================================
2025-07-18 11:12:31.954 | INFO     | info                           | ================================================================================
2025-07-18 11:12:31.981 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:31.982 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:31.982 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:31.997 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:32.004 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:32.010 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:32.010 | INFO     | info                           |    All islands have completed Generation 28.
2025-07-18 11:12:32.014 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 29 ==============================
2025-07-18 11:12:32.014 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:32.014 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:32.014 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:32.014 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:32.053 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:32.053 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:32.054 | INFO     | info                           | GENERATION 29
2025-07-18 11:12:32.054 | INFO     | info                           | GENERATION 29
2025-07-18 11:12:32.054 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:32.054 | INFO     | info                           | ================================================================================
2025-07-18 11:12:32.054 | INFO     | info                           | ================================================================================
2025-07-18 11:12:32.054 | INFO     | info                           | GENERATION 29
2025-07-18 11:12:32.055 | INFO     | info                           | ================================================================================
2025-07-18 11:12:32.082 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:32.082 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:32.082 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:32.099 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:32.104 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:32.109 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:32.109 | INFO     | info                           |    All islands have completed Generation 29.
2025-07-18 11:12:32.114 | INFO     | info                           | 
============================== ARCHIPELAGO GENERATION 30 ==============================
2025-07-18 11:12:32.114 | INFO     | info                           |    Submitting evolution task for Island 1 on cuda:0...
2025-07-18 11:12:32.114 | INFO     | info                           |    Submitting evolution task for Island 2 on cuda:0...
2025-07-18 11:12:32.114 | INFO     | info                           |    Submitting evolution task for Island 3 on cuda:1...
2025-07-18 11:12:32.114 | INFO     | info                           |    All island tasks submitted. Waiting for completion...
2025-07-18 11:12:32.152 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:32.152 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:32.152 | INFO     | info                           | 
================================================================================
2025-07-18 11:12:32.152 | INFO     | info                           | GENERATION 30
2025-07-18 11:12:32.152 | INFO     | info                           | GENERATION 30
2025-07-18 11:12:32.153 | INFO     | info                           | GENERATION 30
2025-07-18 11:12:32.153 | INFO     | info                           | ================================================================================
2025-07-18 11:12:32.153 | INFO     | info                           | ================================================================================
2025-07-18 11:12:32.153 | INFO     | info                           | ================================================================================
2025-07-18 11:12:32.180 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:32.180 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:32.181 | INFO     | info                           | 
üìä Phase 1: Fitness Evaluation (Optimized)
2025-07-18 11:12:32.197 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:32.203 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:32.210 | ERROR    | error                          | An island evolution task failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)
TRACEBACK:
Traceback (most recent call last):
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 71, in evolve_generation
    future.result()
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/root/miniconda3/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/advanced/archipelago_germinal_center.py", line 53, in _evolve_island_worker
    return island_gc.evolve_generation(antigen_batch_device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_germinal_center.py", line 1146, in evolve_generation
    fitness_scores = self.batch_evaluator.evaluate_population_batch(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/parallel_batch_evaluation.py", line 93, in evaluate_population_batch
    predicted_score, cell_representation, _ = cell(antigen_batch)
                                              ^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/production_b_cell.py", line 162, in forward
    gene_output = gene(**call_args)
                  ^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/users/wes/desktop/te_ai/scripts/core/ode.py", line 177, in forward
    h = self.input_projection(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/wes/desktop/new_multi_omics_july10/venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument mat1 in method wrapper_CUDA_addmm)

2025-07-18 11:12:32.210 | INFO     | info                           |    All islands have completed Generation 30.
2025-07-18 11:12:32.211 | INFO     | info                           | 
‚õµ MIGRATION EVENT at Generation 30 ‚õµ
2025-07-18 11:12:32.211 | INFO     | info                           |    Island 1 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:12:32.211 | INFO     | info                           |    Island 2 (on cuda:0) is sending its top 5 cells.
2025-07-18 11:12:32.211 | INFO     | info                           |    Island 3 (on cuda:1) is sending its top 5 cells.
2025-07-18 11:12:32.473 | INFO     | info                           |    Island 1 (on cuda:0) received 5 new cells.
2025-07-18 11:12:32.736 | INFO     | info                           |    Island 2 (on cuda:0) received 5 new cells.
2025-07-18 11:12:33.409 | INFO     | info                           |    Island 3 (on cuda:1) received 5 new cells.
2025-07-18 11:12:33.410 | INFO     | info                           | 
--- Cultivation Complete ---
2025-07-18 11:12:33.410 | INFO     | info                           | Total time for 30 generations: 8.66 seconds.
